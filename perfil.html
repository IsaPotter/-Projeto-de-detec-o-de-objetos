<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M6.644 11.094a.5.5 0 0 1 .356-.15h2a.5.5 0 0 1 .356.15c.175.177.39.347.603.496a7 7 0 0 0 .752.456l.01.006h.003A.5.5 0 0 1 10.5 13h-5a.5.5 0 0 1-.224-.947l.002-.001.01-.006a4 4 0 0 0 .214-.116 8 8 0 0 0 .539-.34c.214-.15.428-.319.603-.496M7 6.5a1 1 0 1 1 2 0 1 1 0 0 1-2 0'/%3E%3Cpath d='M2 3a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm6 1.5a2 2 0 1 1 0 4 2 2 0 0 1 0-4M12.5 7a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1'/%3E%3C/svg%3E">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil - Detecção de Objetos</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="estilo1.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        /* Ajuste para o menu empurrar o conteúdo */
        .sidebar.show-menu + .page-wrapper {
            margin-left: 280px; /* Largura exata do sidebar */
            transition: margin-left 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="hamburguer">
            <div class="line" id="line1"></div>
            <div class="line" id="line2"></div>
            <div class="line" id="line3"></div>
        </div>
        <a href="index.html" class="header-title">Detecção de Objetos</a>
        <div class="header-controls">
            <button id="theme-toggle" class="theme-btn">
                <i class="bi bi-moon-stars-fill"></i>
            </button>
        </div>
    </header>
    <aside class="sidebar">
        <nav>
            <ul class="menu">
                <li class="menu-item"><a href="index.html" class="menu-link"><i class="bi bi-house-door-fill me-2"></i>Início</a></li>
                <li class="menu-item"><a href="sobre.html" class="menu-link"><i class="bi bi-info-circle-fill me-2"></i>Sobre</a></li>
                <li class="menu-item"><a href="faq.html" class="menu-link"><i class="bi bi-question-circle-fill me-2"></i>FAQ</a></li>
                <li class="menu-item"><a href="politica.html" class="menu-link"><i class="bi bi-shield-lock-fill me-2"></i>Privacidade</a></li>
                <li class="menu-item"><a href="assinatura.html" class="menu-link"><i class="bi bi-star-fill me-2"></i>Assinatura</a></li>
                <li class="menu-item"><a href="login.html" class="menu-link active"><i class="bi bi-person-circle me-2"></i>Login</a></li>
            </ul>
        </nav>
        <div class="social-media">
            <a href="https://wa.me/" target="_blank" aria-label="WhatsApp"><i class="bi bi-whatsapp"></i></a>
            <a href="https://linkedin.com/" target="_blank" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
            <a href="https://github.com/" target="_blank" aria-label="GitHub"><i class="bi bi-github"></i></a>
        </div>
    </aside>

    <!-- Conteúdo -->
    <div class="page-wrapper">
        <div class="container" style="max-width: 800px;">
            <header>
                <h1 class="text-center mb-2">Meu Perfil</h1>
                <p class="text-center page-subtitle">Veja as informações da sua conta.</p>
            </header>

            <div class="card">
                <div class="card-body">
                    <div class="profile-info-item">
                        <strong>Email:</strong>
                        <span id="user-email">Carregando...</span>
                    </div>
                    <hr>
                    <div class="profile-info-item">
                        <strong>Plano:</strong>
                        <span id="subscription-status">Carregando...</span>
                    </div>
                    <hr>
                    <div class="profile-actions text-center mt-4">
                        <a href="assinatura.html" class="btn btn-secondary"><i class="bi bi-star-fill me-2"></i>Gerenciar Assinatura</a>
                        <button id="logout-btn" class="btn btn-danger mt-3"><i class="bi bi-box-arrow-right me-2"></i>Sair da Conta</button>
                    </div>
                </div>
            </div>

            <!-- Seção de Estatísticas -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title mb-3"><i class="bi bi-bar-chart-line-fill me-2"></i>Suas Estatísticas</h5>
                    <div class="form-group text-end">
                        <label for="stats-period-select" class="form-label" style="margin-bottom: 0;">Período:</label>
                        <select id="stats-period-select" class="form-select">
                            <option value="7">Últimos 7 dias</option>
                            <option value="30">Últimos 30 dias</option>
                            <option value="all" selected>Todo o período</option>
                        </select>
                    </div>
                    <div class="profile-info-item">
                        <strong>Total de Detecções:</strong>
                        <span id="total-detections" class="stat-value">0</span>
                    </div>
                    <hr>
                    <div class="profile-info-item">
                        <strong>Objeto Mais Detectado:</strong>
                        <span id="most-detected-object" class="stat-value">-</span>
                    </div>
                    <div class="chart-container mt-4">
                        <canvas id="statsChart"></canvas>
                    </div>
                    <div class="text-center mt-3">
                        <button id="export-chart-btn" class="btn btn-secondary"><i class="bi bi-download me-2"></i>Exportar Gráfico (PNG)</button>
                    </div>
                    <p class="form-text text-center mt-3">As estatísticas são baseadas no seu histórico de detecções em todos os dispositivos.</p>
                </div>
            </div>

            <!-- Seção de Alteração de Senha -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title mb-3">Alterar Senha</h5>
                    <form id="change-password-form">
                        <div class="form-group">
                            <label for="current-password">Senha Atual</label>
                            <input type="password" id="current-password" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="new-password">Nova Senha</label>
                            <input type="password" id="new-password" class="form-control" minlength="6" required>
                        </div>
                        <div class="form-group">
                            <label for="confirm-password">Confirmar Nova Senha</label>
                            <input type="password" id="confirm-password" class="form-control" minlength="6" required>
                        </div>
                        <button type="submit" class="btn btn-primary mt-3">Salvar Nova Senha</button>
                    </form>
                    <div id="password-message" class="alert" style="display: none; margin-top: 1rem;"></div>
                </div>
            </div>

            <!-- Seção de Segurança / 2FA -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title mb-3">Segurança da Conta</h5>
                    <div id="2fa-section" class="profile-info-item">
                        <div>
                            <strong>Autenticação de Dois Fatores (2FA)</strong>
                            <p id="2fa-status-text" class="form-text mb-0">Verificando...</p>
                        </div>
                        <button id="toggle-2fa-btn" class="btn btn-secondary" disabled>Carregando...</button>
                    </div>
                </div>
            </div>

            <!-- Log de Atividades -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title mb-3"><i class="bi bi-clock-history me-2"></i>Log de Atividades Recentes</h5>
                    <div class="form-group mb-3">
                        <input type="search" id="activity-log-search" class="form-control" placeholder="Buscar no log (ex: Senha alterada)">
                    </div>
                    <ul id="activity-log-list" class="activity-log">
                        <li class="text-center">Carregando...</li>
                    </ul>
                    <div id="activity-log-pagination" class="pagination-controls mt-3"></div>
                </div>
            </div>

            <!-- Seção de Relatórios e Alertas -->
            <div class="card mt-4">
                <div class="card-body">
                    <div class="profile-info-item">
                        <strong><i class="bi bi-graph-up-arrow me-2"></i>Relatórios e Alertas</strong>
                        <a href="relatorios.html" class="btn btn-secondary">Configurar</a>
                    </div>
                </div>
            </div>

            <!-- Sessões Ativas -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title mb-3"><i class="bi bi-laptop me-2"></i>Sessões Ativas</h5>
                    <p class="form-text mb-3">Esta é uma lista de dispositivos que fizeram login em sua conta. Revogue qualquer sessão que você não reconheça.</p>
                    <ul id="session-list" class="activity-log">
                        <li class="text-center">Carregando sessões...</li>
                    </ul>
                </div>
            </div>

            <!-- Zona de Perigo -->
            <div class="card mt-4 danger-zone">
                <div class="card-body">
                    <h5 class="card-title mb-3">Zona de Perigo</h5>
                    <div class="profile-info-item">
                        <div>
                            <strong>Deletar esta conta</strong>
                            <p class="form-text mb-0">Uma vez que você deletar sua conta, não há como voltar atrás. Tenha certeza.</p>
                        </div>
                        <button id="show-delete-modal-btn" class="btn btn-danger">Deletar Conta</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="page-footer">
            <div class="footer-credits">
                <i class="bi bi-webcam-fill me-2 footer-icon"></i>
                <span>© 2025 Isabela Paiva Novais. Desenvolvido com TensorFlow.js</span>
            </div>
        </footer>
    </div>

    <!-- Modal de Confirmação para Deletar Conta -->
    <div id="delete-account-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-delete-modal">&times;</span>
            <h4>Confirmar Exclusão da Conta</h4>
            <p>Esta ação é irreversível. Para confirmar, por favor, digite sua senha abaixo.</p>
            <form id="delete-account-form">
                <div class="form-group">
                    <label for="delete-confirm-password">Sua Senha</label>
                    <input type="password" id="delete-confirm-password" class="form-control" required>
                </div>
                <div id="delete-message" class="alert" style="display: none; margin-top: 1rem;"></div>
                <button type="submit" id="confirm-delete-btn" class="btn btn-danger btn-block mt-3">
                    Eu entendo as consequências, deletar minha conta
                </button>
            </form>
        </div>
    </div>

    <!-- Modal de Configuração do 2FA -->
    <div id="2fa-setup-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="close-2fa-modal">&times;</span>
            <h4>Configurar Autenticação de Dois Fatores</h4>
            <p>1. Escaneie o QR Code abaixo com seu aplicativo autenticador (Ex: Google Authenticator, Authy).</p>
            <div class="text-center my-3">
                <img id="2fa-qr-code" src="" alt="QR Code para 2FA" style="max-width: 200px; border: 1px solid #ccc; padding: 10px;">
            </div>
            <p class="text-center form-text">Ou insira esta chave manualmente:</p>
            <div class="secret-key-container">
                <span id="2fa-secret-key" class="secret-key"></span>
                <button type="button" id="copy-2fa-secret-btn" class="btn btn-light btn-sm" title="Copiar chave"><i class="bi bi-clipboard"></i></button>
            </div>
            <p>2. Digite o código de 6 dígitos gerado pelo aplicativo para confirmar.</p>
            <form id="2fa-verify-form">
                <div class="form-group">
                    <label for="2fa-token">Código de Verificação</label>
                    <input type="text" id="2fa-token" class="form-control" required pattern="\d{6}" title="Digite o código de 6 dígitos">
                </div>
                <div id="2fa-message" class="alert" style="display: none; margin-top: 1rem;"></div>
                <button type="submit" class="btn btn-primary btn-block mt-3">Ativar 2FA</button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="theme.js"></script>
    <script src="scrip-menu.js"></script>
    <script src="perfil.js"></script>
</body>
</html>